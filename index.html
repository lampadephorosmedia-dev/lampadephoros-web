<!-- FILE: index.html -->
<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lampadēphóros</title>
  <meta name="description" content="Lampadēphóros – Der Fackelträger. Startseite mit automatischer Sprachwahl." />
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <main class="wrap" style="padding:24px;">
    <p>Weiterleitung… <a id="fallbackLink" href="start-de.html">Start</a>.</p>
  </main>

  <script>
  (function () {
    // Default (Fallback)
    const DEFAULT = "start-de.html";

    // Map browser language -> start page
    // (We match BOTH exact and "startsWith" via normalized base code)
    const map = {
      // existing
      "de": "start-de.html",
      "fr": "start-fr.html",
      "en": "start-en.html",
      "pt": "start-pt.html",
      "it": "start-it.html",

      // already planned / added earlier
      "es": "start-es.html",
      "pl": "start-pl.html",
      "ru": "start-ru.html",
      "hr": "start-hr.html",
      "bs": "start-bs.html",
      "sr": "start-sr.html",

      // new additions you want now
      "ku": "start-ku.html",
      "ms": "start-ms.html",
      "ta": "start-ta.html",
      "fa": "start-fa.html",

      // optional later (already prepared to just "exist")
      "ar": "start-ar.html",
      "ur": "start-ur.html",
      "tr": "start-tr.html",
      "zh": "start-zh.html",
      "hi": "start-hi.html",
      "bn": "start-bn.html",
      "id": "start-id.html",
      "fil": "start-fil.html",
      "ja": "start-ja.html",
      "ko": "start-ko.html",
      "vi": "start-vi.html",
      "nl": "start-nl.html",
      "ro": "start-ro.html",
      "uk": "start-uk.html"
    };

    // Get preferred languages (ordered)
    const prefs = (navigator.languages && navigator.languages.length)
      ? navigator.languages
      : [navigator.language || navigator.userLanguage || "de"];

    // Normalize to base language, e.g. "fr-CH" -> "fr"
    const toBase = (tag) => (String(tag || "").toLowerCase().split("-")[0] || "");

    // Choose target
    let target = DEFAULT;

    for (const langTag of prefs) {
      const base = toBase(langTag);

      if (map[langTag]) { // exact match (rare)
        target = map[langTag];
        break;
      }
      if (map[base]) { // base match (common)
        target = map[base];
        break;
      }

      // Special-case Chinese variants -> simplified page (if you use start-zh.html)
      if (base === "zh") {
        target = map["zh"] || DEFAULT;
        break;
      }
    }

    // Update fallback link for users with JS blocked
    const a = document.getElementById("fallbackLink");
    if (a) a.href = target;

    // Redirect
    window.location.replace(target);
  })();
  </script>

  <noscript>
    <p style="padding:24px;">
      JavaScript ist deaktiviert. Bitte öffne den Start manuell:
      <a href="start-de.html">Deutsch</a> ·
      <a href="start-fr.html">Français</a> ·
      <a href="start-en.html">English</a>
    </p>
  </noscript>
</body>
</html>
